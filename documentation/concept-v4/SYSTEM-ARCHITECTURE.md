# Erynoa System-Architektur V4.1

> **Version:** 4.1 â€“ Axiom-Abgeleitete Implementierbare Architektur
> **Datum:** Januar 2026
> **Status:** Referenz-Architektur
> **Basis:** LOGIC.md V4.1 (28 Kern-Axiome + 4 Unter-Axiome)
> **Paradigma:** Dezentral, Skalierbar, Human-Aligned

---

## PrÃ¤ambel: Architektur-Prinzipien

Diese Systemarchitektur ist **direkt aus den Axiomen abgeleitet**:

| Axiom                 | Architektur-Implikation                |
| --------------------- | -------------------------------------- |
| Îš1 (Regelvererbung)   | Hierarchische Realm-Struktur           |
| Îš2-Îš5 (Trust-Algebra) | Trust Engine mit 6D-Vektor             |
| Îš9-Îš10 (KausalitÃ¤t)   | Event-DAG als Kerndatenstruktur        |
| Îš15a-d (Weltformel)   | Surprisal Calculator + Approximationen |
| Îš18 (Konsens)         | Partition-Konsens Engine               |
| Îš19-Îš21 (Schutz)      | Protection Layer                       |
| Îš22-Îš24 (Peer-Logik)  | Gateway + Composer Pattern             |

**Kernziele:**

- **Dezentral**: Kein Single Point of Failure (P2P)
- **Skalierbar**: Bis Milliarden EntitÃ¤ten (durch Îš15d)
- **Human-Aligned**: Verifizierte Menschen haben Ä¤-Bonus
- **Formal Korrekt**: Mathematisch verifizierbare Invarianten

---

## I. Architektur-Ãœbersicht

### 1.1 Schichten-Diagramm

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   ERYNOA SYSTEM-ARCHITEKTUR V4.1                                                                      â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                              CLIENT / PEER LAYER                                                â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â•‘
â•‘   â”‚  â”‚   User       â”‚  â”‚   Peer       â”‚  â”‚   Intent     â”‚  â”‚    Saga      â”‚  â”‚   Gateway    â”‚      â”‚  â•‘
â•‘   â”‚  â”‚   Interface  â”‚â†’â†’â”‚   Node       â”‚â†’â†’â”‚   Parser     â”‚â†’â†’â”‚   Composer   â”‚â†’â†’â”‚   Guard      â”‚      â”‚  â•‘
â•‘   â”‚  â”‚   (Web/App)  â”‚  â”‚ (Îš22-Îš24)   â”‚  â”‚              â”‚  â”‚   (Îš22)     â”‚  â”‚   (Îš23)     â”‚      â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                              â”‚                                                         â•‘
â•‘                                              â–¼                                                         â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                              CORE LOGIC LAYER                                                   â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â•‘
â•‘   â”‚  â”‚   Event      â”‚  â”‚   Trust      â”‚  â”‚  Surprisal   â”‚  â”‚   World      â”‚  â”‚  Consensus   â”‚      â”‚  â•‘
â•‘   â”‚  â”‚   Engine     â”‚â†’â†’â”‚   Engine     â”‚â†’â†’â”‚  Calculator  â”‚â†’â†’â”‚   Formula    â”‚â†’â†’â”‚   Engine     â”‚      â”‚  â•‘
â•‘   â”‚  â”‚   (Îš9-Îš12)  â”‚  â”‚   (Îš2-Îš5)   â”‚  â”‚   (Îš15a)    â”‚  â”‚   (Îš15b-d)  â”‚  â”‚   (Îš18)     â”‚      â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                              â”‚                                                         â•‘
â•‘                                              â–¼                                                         â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                              STORAGE / REALM LAYER                                              â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚  â•‘
â•‘   â”‚  â”‚   Event      â”‚  â”‚   Identity   â”‚  â”‚    Realm     â”‚  â”‚   Credential â”‚                        â”‚  â•‘
â•‘   â”‚  â”‚   Store      â”‚  â”‚   Store      â”‚  â”‚   Hierarchy  â”‚  â”‚   Vault      â”‚                        â”‚  â•‘
â•‘   â”‚  â”‚   (DAG)      â”‚  â”‚   (DIDs)     â”‚  â”‚   (Îš1)      â”‚  â”‚   (VCs)      â”‚                        â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                              â”‚                                                         â•‘
â•‘                                              â–¼                                                         â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                              PROTECTION LAYER                                                   â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚  â•‘
â•‘   â”‚  â”‚   Anti-      â”‚  â”‚   Diversity  â”‚  â”‚   Quadratic  â”‚  â”‚   Anomaly    â”‚                        â”‚  â•‘
â•‘   â”‚  â”‚ Calcificationâ”‚  â”‚   Monitor    â”‚  â”‚   Governance â”‚  â”‚   Detector   â”‚                        â”‚  â•‘
â•‘   â”‚  â”‚   (Îš19)     â”‚  â”‚   (Îš20)     â”‚  â”‚   (Îš21)     â”‚  â”‚   (V-Dim)    â”‚                        â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   CROSS-CUTTING CONCERNS:                                                                             â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â•‘
â•‘   â”‚   Crypto     â”‚  â”‚   P2P        â”‚  â”‚   Telemetry  â”‚  â”‚   Config     â”‚  â”‚   ECLVM      â”‚          â•‘
â•‘   â”‚   (Ed25519)  â”‚  â”‚   (Libp2p)   â”‚  â”‚   (Metrics)  â”‚  â”‚   (TOML)     â”‚  â”‚   (Logic)    â”‚          â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 1.2 Mermaid-Diagramm (Interaktiv)

```mermaid
graph TD
    subgraph "Client / Peer Layer"
        A[User Interface<br/>Web/Mobile/App] --> B[Peer Node<br/>Gateway + Composer]
        B --> C[Intent Parser]
        C --> D[Saga Composer<br/>Îš22]
        D --> E[Gateway Guard<br/>Îš23]
    end

    subgraph "Core Logic Layer"
        E --> F[Event Engine<br/>Causal DAG Îš9-Îš12]
        F --> G[Trust Engine<br/>ğ•‹ Funktor, ğ• Vektor Îš2-Îš5]
        G --> H[Surprisal Calculator<br/>â„ Sketch, ğ’® DÃ¤mpfung Îš15a]
        H --> I[World Formula Engine<br/>ğ”¼ Berechnung Îš15b-d]
        I --> J[Consensus Engine<br/>Î¨ Partition-Konsens Îš18]
    end

    subgraph "Storage / Realm Layer"
        F --> K[Event Store<br/>Immutable DAG]
        G --> L[Identity Store<br/>DIDs, Delegation âŠ³]
        I --> M[Realm Hierarchy<br/>Root â†’ Virtual â†’ Partition Îš1]
        M --> K
    end

    subgraph "Protection Layer"
        I --> N[Anti-Degeneration<br/>Îš19-Îš21]
        J --> N
    end

    B <-.P2P.-> B
    K <-.Distributed.-> K
    M <-.Sync.-> M

    style A fill:#e3f2fd
    style B fill:#e3f2fd
    style C fill:#e3f2fd
    style D fill:#e3f2fd
    style E fill:#e3f2fd
    style F fill:#f3e5f5
    style G fill:#f3e5f5
    style H fill:#f3e5f5
    style I fill:#f3e5f5
    style J fill:#f3e5f5
    style K fill:#e8f5e9
    style L fill:#e8f5e9
    style M fill:#e8f5e9
    style N fill:#fff3e0
```

---

## II. Client / Peer Layer

### 2.1 Peer Node (Îš22-Îš24)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   PEER NODE ARCHITEKTUR                                                                               â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   Jeder Nutzer betreibt einen Peer Node â€“ die fundamentale Einheit der Dezentralisierung.            â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                                    PEER NODE                                                    â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â•‘
â•‘   â”‚   â”‚   INTENT PARSER   â”‚    â”‚   SAGA COMPOSER   â”‚    â”‚   GATEWAY GUARD   â”‚                      â”‚  â•‘
â•‘   â”‚   â”‚                   â”‚    â”‚                   â”‚    â”‚                   â”‚                      â”‚  â•‘
â•‘   â”‚   â”‚ â€¢ NL â†’ Struktur   â”‚â”€â”€â”€â–¶â”‚ â€¢ RÃ¼ckwÃ¤rts-Aufl. â”‚â”€â”€â”€â–¶â”‚ â€¢ Rule Evaluation â”‚                      â”‚  â•‘
â•‘   â”‚   â”‚ â€¢ Goal Extraction â”‚    â”‚ â€¢ Dependency Graphâ”‚    â”‚ â€¢ Trust DÃ¤mpfung  â”‚                      â”‚  â•‘
â•‘   â”‚   â”‚ â€¢ Budget Parsing  â”‚    â”‚ â€¢ Topo-Sort       â”‚    â”‚ â€¢ Realm Crossing  â”‚                      â”‚  â•‘
â•‘   â”‚   â”‚                   â”‚    â”‚                   â”‚    â”‚                   â”‚                      â”‚  â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â•‘
â•‘   â”‚   â”‚                              LOCAL STATE                                                  â”‚â”‚  â•‘
â•‘   â”‚   â”‚  â€¢ Own DID + Keys         â€¢ Cached Trust Vectors      â€¢ Pending Sagas                    â”‚â”‚  â•‘
â•‘   â”‚   â”‚  â€¢ Delegation Tree        â€¢ Recent Events             â€¢ Subscription List                â”‚â”‚  â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â•‘
â•‘   â”‚   â”‚                              P2P INTERFACE                                                â”‚â”‚  â•‘
â•‘   â”‚   â”‚  â€¢ Libp2p Transport       â€¢ Gossip Protocol           â€¢ DHT Lookup                       â”‚â”‚  â•‘
â•‘   â”‚   â”‚  â€¢ Multiplexing           â€¢ NAT Traversal             â€¢ Peer Discovery                   â”‚â”‚  â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2.2 Intent Parser

```rust
// Pseudo-Rust fÃ¼r Intent Parsing

/// Ein Intent reprÃ¤sentiert eine Nutzer-Absicht
pub struct Intent {
    pub goal: Goal,
    pub constraints: Vec<Constraint>,
    pub budget: Budget,
    pub source_did: DID,
    pub context: RealmContext,
}

/// Goals sind typisiert
pub enum Goal {
    Transfer { to: DID, amount: Value, asset: AssetType },
    Attest { claim: Claim, subject: DID },
    Delegate { capability: Capability, to: DID, ttl: Duration },
    Query { predicate: Predicate },
    Create { entity_type: EntityType, params: Params },
}

/// Parser-Funktion (Îš22: âˆ€ Intent I : âˆƒ! Saga S)
pub fn parse_intent(raw: &str, ctx: &Context) -> Result<Intent, ParseError> {
    let tokens = tokenize(raw)?;
    let goal = extract_goal(&tokens)?;
    let constraints = extract_constraints(&tokens)?;
    let budget = extract_budget(&tokens, ctx.default_budget)?;

    Ok(Intent { goal, constraints, budget, source_did: ctx.did.clone(), context: ctx.realm.clone() })
}
```

### 2.3 Saga Composer (Îš22)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   SAGA COMPOSER ALGORITHMUS (RÃ¼ckwÃ¤rts-AuflÃ¶sung)                                                     â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   INPUT:  Intent I mit Goal G                                                                         â•‘
â•‘   OUTPUT: Saga S = [Stepâ‚, Stepâ‚‚, ..., Stepâ‚™] in topologischer Reihenfolge                           â•‘
â•‘                                                                                                        â•‘
â•‘   ALGORITHMUS:                                                                                        â•‘
â•‘                                                                                                        â•‘
â•‘   1. GOAL DECOMPOSITION                                                                               â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                            â•‘
â•‘      required_resources = analyze_dependencies(G)                                                     â•‘
â•‘      // z.B. Transfer(100 ERY) â†’ [check_balance, lock_funds, execute, unlock]                        â•‘
â•‘                                                                                                        â•‘
â•‘   2. RESOURCE SOURCING                                                                                â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                            â•‘
â•‘      for each resource in required_resources:                                                         â•‘
â•‘          source = find_source(resource, budget, trust_threshold)                                      â•‘
â•‘          if source.realm â‰  current_realm:                                                             â•‘
â•‘              add_realm_crossing(source.realm, current_realm)                                          â•‘
â•‘                                                                                                        â•‘
â•‘   3. DEPENDENCY GRAPH                                                                                 â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                            â•‘
â•‘      G = build_graph(steps, dependencies)                                                             â•‘
â•‘      // DAG mit Steps als Knoten, AbhÃ¤ngigkeiten als Kanten                                          â•‘
â•‘                                                                                                        â•‘
â•‘   4. TOPOLOGICAL SORT                                                                                 â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                            â•‘
â•‘      execution_order = topo_sort(G)                                                                   â•‘
â•‘      // Kahn's Algorithm oder DFS-basiert                                                             â•‘
â•‘                                                                                                        â•‘
â•‘   5. SAGA CONSTRUCTION                                                                                â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                            â•‘
â•‘      S = Saga {                                                                                       â•‘
â•‘          steps: execution_order,                                                                      â•‘
â•‘          compensations: generate_compensations(steps),  // FÃ¼r Rollback                              â•‘
â•‘          timeout: calculate_timeout(steps),                                                           â•‘
â•‘          atomicity: AtomicityLevel::Saga,  // Îš14                                                    â•‘
â•‘      }                                                                                                â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   BEISPIEL:                                                                                           â•‘
â•‘                                                                                                        â•‘
â•‘   Intent: "Kaufe 10 ERY Wissen von did:erynoa:self:alice"                                            â•‘
â•‘                                                                                                        â•‘
â•‘   Saga:                                                                                               â•‘
â•‘       Step 1: verify_identity(self)                                                                   â•‘
â•‘       Step 2: check_balance(self, 10 ERY)                                                            â•‘
â•‘       Step 3: query_offer(alice, knowledge_type)                                                      â•‘
â•‘       Step 4: lock_funds(self, 10 ERY)                        â”€â”                                      â•‘
â•‘       Step 5: lock_knowledge(alice, knowledge_id)              â”‚ Atomic (Îš14)                        â•‘
â•‘       Step 6: execute_swap(self â†” alice)                       â”‚                                      â•‘
â•‘       Step 7: finalize(create_events)                         â”€â”˜                                      â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2.4 Gateway Guard (Îš23)

```rust
/// Gateway Guard â€“ prÃ¼ft Realm-ÃœbergÃ¤nge
pub struct GatewayGuard {
    rules_engine: RulesEngine,
    trust_dampening: TrustDampeningMatrix,
}

impl GatewayGuard {
    /// Îš23: âˆ€ (src â†’ tgt) âˆˆ Saga : guard(user, tgt) muss evaluiert werden
    pub fn evaluate(&self, user: &DID, source_realm: &Realm, target_realm: &Realm, saga: &Saga) -> GuardResult {
        // 1. Collect all predicates for target realm
        let predicates = target_realm.get_predicates();

        // 2. Evaluate each predicate
        let results: Vec<bool> = predicates.iter()
            .map(|p| p.evaluate(user, &self.get_trust_vector(user)))
            .collect();

        // 3. Îš23: guard(u, ctx) = âˆ§áµ¢ Predicateáµ¢(u.identity, u.trust, ctx.rules)
        let all_pass = results.iter().all(|&r| r);

        if !all_pass {
            return GuardResult::Denied { reason: "Predicate failed" };
        }

        // 4. Îš24: Trust-DÃ¤mpfung bei Realm-Crossing
        // ğ•_target = M_ctx Ã— ğ•_source mit â€–M_ctxâ€– â‰¤ 1
        let dampened_trust = self.trust_dampening.apply(
            &self.get_trust_vector(user),
            source_realm,
            target_realm
        );

        GuardResult::Allowed { dampened_trust }
    }
}

/// Trust-DÃ¤mpfungsmatrix (Îš24)
pub struct TrustDampeningMatrix {
    /// 6x6 Matrix fÃ¼r jede Realm-Kombination
    matrices: HashMap<(RealmId, RealmId), Matrix6x6>,
}

impl TrustDampeningMatrix {
    /// â€–M_ctxâ€– â‰¤ 1 garantiert, dass Trust nicht steigen kann
    pub fn apply(&self, trust: &TrustVector6D, from: &Realm, to: &Realm) -> TrustVector6D {
        let m = self.matrices.get(&(from.id, to.id))
            .unwrap_or(&Matrix6x6::identity());

        // Îš24: ğ•_target = M_ctx Ã— ğ•_source
        m.multiply(trust)
    }
}
```

---

## III. Core Logic Layer

### 3.1 Event Engine (Îš9-Îš12)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   EVENT ENGINE â€“ KAUSALER DAG                                                                         â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   DATENSTRUKTUR (Îš9: DAG mit âŠ² Relation):                                                             â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚                    â”Œâ”€â”€â”€â”€â”€â”                                                                      â”‚  â•‘
â•‘   â”‚                    â”‚ eâ‚  â”‚ Genesis                                                              â”‚  â•‘
â•‘   â”‚                    â””â”€â”€â”¬â”€â”€â”˜                                                                      â”‚  â•‘
â•‘   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                                                  â”‚  â•‘
â•‘   â”‚              â–¼               â–¼                                                                  â”‚  â•‘
â•‘   â”‚          â”Œâ”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”                                                                â”‚  â•‘
â•‘   â”‚          â”‚ eâ‚‚  â”‚         â”‚ eâ‚ƒ  â”‚                                                                â”‚  â•‘
â•‘   â”‚          â””â”€â”€â”¬â”€â”€â”˜         â””â”€â”€â”¬â”€â”€â”˜                                                                â”‚  â•‘
â•‘   â”‚             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                   â”‚  â•‘
â•‘   â”‚             â–¼    â–¼                                                                              â”‚  â•‘
â•‘   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                            â”‚  â•‘
â•‘   â”‚          â”‚   eâ‚„    â”‚  (eâ‚‚ âŠ² eâ‚„) âˆ§ (eâ‚ƒ âŠ² eâ‚„)                                                    â”‚  â•‘
â•‘   â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                                            â”‚  â•‘
â•‘   â”‚               â–¼                                                                                 â”‚  â•‘
â•‘   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                            â”‚  â•‘
â•‘   â”‚          â”‚   eâ‚…    â”‚  Newest (NASCENT)                                                          â”‚  â•‘
â•‘   â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                            â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   EVENT STRUKTUR:                                                                                     â•‘
â•‘                                                                                                        â•‘
â•‘   struct Event {                                                                                      â•‘
â•‘       id: EventId,                    // Hash(content + parents)                                      â•‘
â•‘       parents: Vec<EventId>,          // Kausale VorgÃ¤nger (âŠ²)                                       â•‘
â•‘       author: DID,                    // Ersteller                                                    â•‘
â•‘       timestamp: Timestamp,           // Logische Uhr                                                 â•‘
â•‘       payload: EventPayload,          // Inhalt                                                       â•‘
â•‘       signature: Signature,           // Ed25519                                                      â•‘
â•‘       finality: FinalityLevel,        // NASCENT â†’ ETERNAL                                           â•‘
â•‘   }                                                                                                   â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   FINALITÃ„TS-SPEKTRUM (Îš10):                                                                          â•‘
â•‘                                                                                                        â•‘
â•‘       NASCENT     â”€â”€â–¶  VALIDATED   â”€â”€â–¶  WITNESSED   â”€â”€â–¶  ANCHORED   â”€â”€â–¶  ETERNAL                     â•‘
â•‘       (0.5)            (0.9)            (0.99)           (0.999)         (1 - 10â»âµâ°)                 â•‘
â•‘                                                                                                        â•‘
â•‘       Transition-Bedingungen:                                                                         â•‘
â•‘       â€¢ NASCENT â†’ VALIDATED:    Signature valid + Parents exist                                       â•‘
â•‘       â€¢ VALIDATED â†’ WITNESSED:  n Witnesses mit Trust â‰¥ Î¸                                            â•‘
â•‘       â€¢ WITNESSED â†’ ANCHORED:   Merkle-Root in externem System                                        â•‘
â•‘       â€¢ ANCHORED â†’ ETERNAL:     k BestÃ¤tigungen auf Anchor-Chain                                     â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

```rust
/// Event Engine Implementation
pub struct EventEngine {
    dag: CausalDAG,
    finality_tracker: FinalityTracker,
    witnesses: WitnessPool,
}

impl EventEngine {
    /// Îš12: âˆ€Î  : âŸ¦Î âŸ§ â†’ Î”|â„‚| â‰¥ 1
    /// Jeder bezeugte Prozess erzeugt mindestens ein Event
    pub fn create_event(&mut self, process: &Process, author: &DID) -> Result<Event, EventError> {
        // 1. Validate process completion
        if !process.is_complete() {
            return Err(EventError::ProcessIncomplete);
        }

        // 2. Find causal parents (latest events this depends on)
        let parents = self.dag.find_causal_parents(&process.dependencies);

        // 3. Create event
        let event = Event {
            id: EventId::new(), // Will be set after hashing
            parents,
            author: author.clone(),
            timestamp: LogicalClock::now(),
            payload: process.to_payload(),
            signature: Signature::pending(),
            finality: FinalityLevel::Nascent,
        };

        // 4. Sign and hash
        let signed_event = event.sign(author)?;
        let final_event = signed_event.with_id(hash(&signed_event));

        // 5. Insert into DAG (Îš9: DAG-Invariante)
        self.dag.insert(final_event.clone())?;

        Ok(final_event)
    }

    /// Îš9: Kausale Ordnung prÃ¼fen
    pub fn is_causal_ancestor(&self, ancestor: &EventId, descendant: &EventId) -> bool {
        self.dag.is_ancestor(ancestor, descendant)
    }
}
```

### 3.2 Trust Engine (Îš2-Îš5)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   TRUST ENGINE â€“ 6-DIMENSIONALER VEKTOR                                                               â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   TRUST-VEKTOR ğ• âˆˆ [0,1]â¶ (Îš3):                                                                       â•‘
â•‘                                                                                                        â•‘
â•‘                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â•‘
â•‘                    â”‚                                                             â”‚                    â•‘
â•‘                    â”‚   ğ•(s,Îµ,t) = (R, I, C, P, V, Î©)                            â”‚                    â•‘
â•‘                    â”‚                                                             â”‚                    â•‘
â•‘                    â”‚   R = Reliability    (Verhaltens-Historie)                  â”‚                    â•‘
â•‘                    â”‚   I = Integrity      (Aussage-Konsistenz)                   â”‚                    â•‘
â•‘                    â”‚   C = Competence     (FÃ¤higkeits-Nachweis)                  â”‚                    â•‘
â•‘                    â”‚   P = Prestige       (Externe Attestation)                  â”‚                    â•‘
â•‘                    â”‚   V = Vigilance      (Anomalie-Erkennung)                   â”‚                    â•‘
â•‘                    â”‚   Î© = Omega          (Axiom-Treue)                          â”‚                    â•‘
â•‘                    â”‚                                                             â”‚                    â•‘
â•‘                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   UPDATE-REGELN (Îš4: Asymmetrische Evolution):                                                        â•‘
â•‘                                                                                                        â•‘
â•‘       Î”âº(dim) = base_delta                                                                            â•‘
â•‘       Î”â»(dim) = Î»_asym Â· base_delta    wobei Î» = 1.5 (R,I,C,P), 2.0 (V,Î©)                            â•‘
â•‘                                                                                                        â•‘
â•‘   KOMBINATION (Îš5: Probabilistisch):                                                                  â•‘
â•‘                                                                                                        â•‘
â•‘       tâ‚ âŠ• tâ‚‚ = 1 - (1-tâ‚)(1-tâ‚‚)                                                                      â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   KONTEXT-GEWICHTE (Îš15b):                                                                            â•‘
â•‘                                                                                                        â•‘
â•‘       Kontext              R      I      C      P      V      Î©                                       â•‘
â•‘       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â•‘
â•‘       Finanztransaktion   0.30   0.25   0.15   0.10   0.15   0.05                                     â•‘
â•‘       Wissensaustausch    0.10   0.30   0.30   0.15   0.10   0.05                                     â•‘
â•‘       Governance          0.15   0.20   0.15   0.20   0.10   0.20                                     â•‘
â•‘       Default             0.17   0.17   0.17   0.17   0.16   0.16                                     â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

```rust
/// Trust Engine Implementation
pub struct TrustEngine {
    vectors: HashMap<DID, TrustVector6D>,
    context_weights: HashMap<ContextType, [f64; 6]>,
    asymmetry_factors: [f64; 6],  // Î» per dimension
}

#[derive(Clone, Debug)]
pub struct TrustVector6D {
    pub r: f64,  // Reliability
    pub i: f64,  // Integrity
    pub c: f64,  // Competence
    pub p: f64,  // Prestige
    pub v: f64,  // Vigilance
    pub omega: f64,  // Omega (Axiom-Treue)
}

impl TrustEngine {
    /// Îš4: Asymmetrische Evolution
    pub fn update(&mut self, did: &DID, event: &TrustEvent) {
        let vector = self.vectors.entry(did.clone()).or_insert(TrustVector6D::default());

        let (dimension, delta, is_positive) = self.analyze_event(event);

        let effective_delta = if is_positive {
            delta
        } else {
            delta * self.asymmetry_factors[dimension as usize]
        };

        vector.update_dimension(dimension, effective_delta, is_positive);
    }

    /// Îš5: Probabilistische Kombination
    pub fn combine(t1: f64, t2: f64) -> f64 {
        1.0 - (1.0 - t1) * (1.0 - t2)
    }

    /// Îš15b: Gewichtete Norm
    pub fn weighted_norm(&self, vector: &TrustVector6D, context: ContextType) -> f64 {
        let weights = self.context_weights.get(&context)
            .unwrap_or(&[0.17, 0.17, 0.17, 0.17, 0.16, 0.16]);

        let sum: f64 = [vector.r, vector.i, vector.c, vector.p, vector.v, vector.omega]
            .iter()
            .zip(weights.iter())
            .map(|(v, w)| w * v * v)
            .sum();

        sum.sqrt()
    }

    /// Î¤1: Ketten-Trust
    pub fn chain_trust(chain: &[f64]) -> f64 {
        let n = chain.len() as f64;
        let log_sum: f64 = chain.iter().map(|t| t.ln()).sum();
        (log_sum / n.sqrt()).exp()
    }
}
```

### 3.3 Surprisal Calculator (Îš15a)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   SURPRISAL CALCULATOR â€“ INFORMATIONSTHEORETISCH                                                      â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   SHANNON-SURPRISAL (Îš15a):                                                                           â•‘
â•‘                                                                                                        â•‘
â•‘       â„(e|s) = âˆ’logâ‚‚ P(e | â„‚(s))                                                                      â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   SKETCH-BASIERTE APPROXIMATION (O(1) pro Event):                                                     â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   1. EVENT-FINGERPRINTING (MinHash)                                                            â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚  â•‘
â•‘   â”‚      fingerprint(e) = MinHash(                                                                 â”‚  â•‘
â•‘   â”‚          event_type(e),                                                                        â”‚  â•‘
â•‘   â”‚          involved_dids(e),                                                                     â”‚  â•‘
â•‘   â”‚          value_bucket(e)                                                                       â”‚  â•‘
â•‘   â”‚      )                                                                                         â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   2. FREQUENCY ESTIMATION (Count-Min Sketch)                                                   â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚  â•‘
â•‘   â”‚      count â‰ˆ CMS.query(fingerprint(e))                                                        â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   3. PROBABILITY ESTIMATION                                                                    â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚  â•‘
â•‘   â”‚      P(e | â„‚_recent) â‰ˆ count / |â„‚_recent|                                                     â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   4. SURPRISAL                                                                                 â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                             â”‚  â•‘
â•‘   â”‚      â„(e) = âˆ’logâ‚‚(P(e | â„‚_recent))                                                            â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   TRUST-GEDÃ„MPFTE SURPRISAL ğ’® (Anti-Hype):                                                            â•‘
â•‘                                                                                                        â•‘
â•‘       ğ’®(s) = â€–ğ•(s)â€–Â² Â· â„(s)                                                                          â•‘
â•‘                                                                                                        â•‘
â•‘   BEISPIEL:                                                                                           â•‘
â•‘       Agent mit ğ• = 0.3:  ğ’® = 0.09 Â· â„   (91% DÃ¤mpfung)                                              â•‘
â•‘       Agent mit ğ• = 0.9:  ğ’® = 0.81 Â· â„   (19% DÃ¤mpfung)                                              â•‘
â•‘                                                                                                        â•‘
â•‘   â†’ Verhindert: Hype-Zyklen, Spam-Belohnung, Sybil-Novelty-Farming                                   â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

```rust
/// Surprisal Calculator Implementation
pub struct SurprisalCalculator {
    count_min_sketch: CountMinSketch,
    minhash: MinHash,
    recent_window: Duration,
    recent_count: AtomicU64,
}

impl SurprisalCalculator {
    /// Îš15a: Shannon-Surprisal
    pub fn calculate_surprisal(&self, event: &Event) -> f64 {
        // 1. Fingerprint the event
        let fingerprint = self.minhash.hash(&EventFeatures::from(event));

        // 2. Query frequency
        let count = self.count_min_sketch.query(&fingerprint) as f64;
        let total = self.recent_count.load(Ordering::Relaxed) as f64;

        // 3. Estimate probability (with Laplace smoothing)
        let probability = (count + 1.0) / (total + 1.0);

        // 4. Calculate surprisal: â„ = âˆ’logâ‚‚ P
        -probability.log2()
    }

    /// Trust-gedÃ¤mpfte Surprisal (Anti-Hype)
    pub fn dampened_surprisal(&self, event: &Event, trust_norm: f64) -> f64 {
        let surprisal = self.calculate_surprisal(event);

        // ğ’® = â€–ğ•â€–Â² Â· â„
        trust_norm.powi(2) * surprisal
    }

    /// Update sketch with new event
    pub fn observe(&mut self, event: &Event) {
        let fingerprint = self.minhash.hash(&EventFeatures::from(event));
        self.count_min_sketch.insert(&fingerprint);
        self.recent_count.fetch_add(1, Ordering::Relaxed);
    }
}

/// Count-Min Sketch fÃ¼r O(1) Frequency Estimation
pub struct CountMinSketch {
    width: usize,
    depth: usize,
    table: Vec<Vec<u32>>,
    hash_functions: Vec<Box<dyn Fn(&[u8]) -> usize>>,
}

impl CountMinSketch {
    pub fn query(&self, item: &[u8]) -> u32 {
        self.hash_functions.iter()
            .enumerate()
            .map(|(i, h)| self.table[i][h(item) % self.width])
            .min()
            .unwrap_or(0)
    }

    pub fn insert(&mut self, item: &[u8]) {
        for (i, h) in self.hash_functions.iter().enumerate() {
            let idx = h(item) % self.width;
            self.table[i][idx] = self.table[i][idx].saturating_add(1);
        }
    }
}
```

### 3.4 World Formula Engine (Îš15b-d)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   WORLD FORMULA ENGINE â€“ ğ”¼ BERECHNUNG                                                                 â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   WELTFORMEL V2.0:                                                                                    â•‘
â•‘                                                                                                        â•‘
â•‘       ğ”¼ = Î£  ğ”¸(s) Â· Ïƒâƒ—( â€–ğ•(s)â€–_w Â· ln|â„‚(s)| Â· ğ’®(s) ) Â· Ä¤(s) Â· w(s,t)                                 â•‘
â•‘           sâˆˆğ’                                                                                         â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   APPROXIMATIONS-STRATEGIEN (Îš15d):                                                                   â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   1. HIERARCHISCHE AGGREGATION (fÃ¼r Batch-Analyse)                                             â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚  â•‘
â•‘   â”‚      ğ”¼ â‰ˆ Î£_partitions ğ”¼_partition                                                              â”‚  â•‘
â•‘   â”‚      ğ”¼_partition = |partition| Â· mean(sample(partition, k))                                   â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚      KomplexitÃ¤t: O(|Partitions| Â· k) statt O(|ğ’|)                                             â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   2. STREAMING APPROXIMATION (fÃ¼r Echtzeit)                                                    â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚  â•‘
â•‘   â”‚      ğ”¼(t+1) = Î± Â· ğ”¼(t) + (1-Î±) Â· Î£_new f(s_new)                                               â”‚  â•‘
â•‘   â”‚      Î± = exp(-Î”t / Ï„_update)                                                                   â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚      KomplexitÃ¤t: O(|neue Events|) pro Update                                                  â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   3. IMPORTANCE SAMPLING (fÃ¼r statistische Analyse)                                            â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚  â•‘
â•‘   â”‚      ğ”¼ â‰ˆ (1/k) Â· Î£áµ¢ f(sáµ¢) / q(sáµ¢)                                                             â”‚  â•‘
â•‘   â”‚      wobei sáµ¢ ~ q(s) âˆ ğ”¸(s) Â· â€–ğ•(s)â€–                                                          â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚      Minimiert Varianz durch intelligentes Sampling                                            â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

```rust
/// World Formula Engine
pub struct WorldFormulaEngine {
    trust_engine: Arc<TrustEngine>,
    surprisal_calc: Arc<SurprisalCalculator>,
    event_engine: Arc<EventEngine>,
    realm_hierarchy: Arc<RealmHierarchy>,

    // Streaming state
    current_e: AtomicF64,
    last_update: AtomicU64,
    tau_update: Duration,
}

impl WorldFormulaEngine {
    /// Berechne Beitrag eines einzelnen Subjects zur Weltformel
    fn compute_contribution(&self, s: &DID, context: ContextType, t: Timestamp) -> f64 {
        // ğ”¸(s) - AktivitÃ¤ts-PrÃ¤senz
        let activity = self.compute_activity(s);

        // â€–ğ•(s)â€–_w - Gewichtete Trust-Norm
        let trust_vector = self.trust_engine.get_vector(s);
        let trust_norm = self.trust_engine.weighted_norm(&trust_vector, context);

        // |â„‚(s)| - GrÃ¶ÃŸe der kausalen Geschichte
        let causal_history_size = self.event_engine.causal_history_size(s);

        // ğ’®(s) - Trust-gedÃ¤mpfte Surprisal
        let surprisal = self.surprisal_calc.dampened_surprisal_for_subject(s, trust_norm);

        // Ä¤(s) - Human-Alignment Factor (Îš16)
        let human_factor = self.compute_human_factor(s);

        // w(s,t) - Temporale Gewichtung (Îš17)
        let temporal_weight = self.compute_temporal_weight(s, t);

        // Ïƒâƒ— - Sigmoid
        let inner = trust_norm * (causal_history_size as f64).ln() * surprisal;
        let sigmoid = 1.0 / (1.0 + (-inner).exp());

        // Kombination
        activity * sigmoid * human_factor * temporal_weight
    }

    /// Îš16: Human-Alignment Factor
    fn compute_human_factor(&self, s: &DID) -> f64 {
        match self.get_human_status(s) {
            HumanStatus::VerifiedHuman => 2.0,
            HumanStatus::HumanControlled => 1.5,
            HumanStatus::Unknown => 1.0,
        }
    }

    /// Îš17: Temporale Vergebung
    fn compute_temporal_weight(&self, s: &DID, t: Timestamp) -> f64 {
        let events = self.event_engine.get_events_for(s);

        events.iter().map(|e| {
            let age = t - e.timestamp;
            let gamma = if e.is_negative() {
                0.000633  // 3 Jahre Halbwertszeit
            } else {
                0.000380  // 5 Jahre Halbwertszeit
            };
            (-gamma * age.as_days() as f64).exp()
        }).sum::<f64>() / events.len() as f64
    }

    /// Îš15d: Streaming Approximation
    pub fn update_streaming(&self, new_events: &[Event]) {
        let now = Timestamp::now();
        let last = Timestamp::from_millis(self.last_update.load(Ordering::Relaxed));
        let dt = (now - last).as_secs_f64();

        // Î± = exp(-Î”t / Ï„_update)
        let alpha = (-dt / self.tau_update.as_secs_f64()).exp();

        // Neue BeitrÃ¤ge berechnen
        let new_contribution: f64 = new_events.iter()
            .map(|e| self.compute_contribution(&e.author, ContextType::Default, now))
            .sum();

        // ğ”¼(t+1) = Î± Â· ğ”¼(t) + (1-Î±) Â· Î£_new f(s_new)
        let current = self.current_e.load(Ordering::Relaxed);
        let updated = alpha * current + (1.0 - alpha) * new_contribution;

        self.current_e.store(updated, Ordering::Relaxed);
        self.last_update.store(now.as_millis(), Ordering::Relaxed);
    }

    /// Îš15d: Hierarchische Aggregation
    pub fn compute_hierarchical(&self, sample_size: usize) -> f64 {
        self.realm_hierarchy.partitions().iter()
            .map(|partition| {
                let members = partition.members();
                let sample: Vec<_> = members.choose_multiple(&mut rand::thread_rng(), sample_size).collect();

                let sample_mean: f64 = sample.iter()
                    .map(|s| self.compute_contribution(s, ContextType::Default, Timestamp::now()))
                    .sum::<f64>() / sample_size as f64;

                members.len() as f64 * sample_mean
            })
            .sum()
    }
}
```

### 3.5 Consensus Engine (Îš18)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   CONSENSUS ENGINE â€“ PARTITION-KONSENS                                                                â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   Îš18 KONSENS-KONSTITUTION:                                                                           â•‘
â•‘                                                                                                        â•‘
â•‘                    Î£ ğ•(s) Â· [s âŠ¢ Ï†]                                                                   â•‘
â•‘       Î¨(Î£)(Ï†) = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â•‘
â•‘                      Î£ ğ•(s)                                                                           â•‘
â•‘                  s âŠ¢ Î£                                                                                â•‘
â•‘                                                                                                        â•‘
â•‘       Î¸_konsens = 2/3 (SupermajoritÃ¤t)                                                                â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   PROZESS:                                                                                            â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   1. PROPOSAL PHASE                                                                            â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                          â”‚  â•‘
â•‘   â”‚      Proposer p broadcasts Ï† to Partition Î£                                                    â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   2. VOTING PHASE                                                                              â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                              â”‚  â•‘
â•‘   â”‚      Each member s âˆˆ Î£:                                                                        â”‚  â•‘
â•‘   â”‚          vote(s, Ï†) = { 1 if accepts Ï†, 0 otherwise }                                          â”‚  â•‘
â•‘   â”‚          weight(s) = â€–ğ•(s)â€–_governance                                                         â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   3. AGGREGATION PHASE                                                                         â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                          â”‚  â•‘
â•‘   â”‚      Î¨(Î£)(Ï†) = Î£ weight(s) Â· vote(s, Ï†) / Î£ weight(s)                                         â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚   4. DECISION PHASE                                                                            â”‚  â•‘
â•‘   â”‚      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                            â”‚  â•‘
â•‘   â”‚      if Î¨(Î£)(Ï†) > Î¸_konsens:                                                                   â”‚  â•‘
â•‘   â”‚          Ï† becomes Partition-Wahrheit                                                          â”‚  â•‘
â•‘   â”‚          broadcast_decision(Ï†, ACCEPTED)                                                       â”‚  â•‘
â•‘   â”‚      else:                                                                                     â”‚  â•‘
â•‘   â”‚          broadcast_decision(Ï†, REJECTED)                                                       â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

```rust
/// Consensus Engine
pub struct ConsensusEngine {
    trust_engine: Arc<TrustEngine>,
    threshold: f64,  // Î¸_konsens = 2/3
}

impl ConsensusEngine {
    /// Îš18: Gewichteter Konsens
    pub fn compute_consensus(&self, partition: &Partition, proposal: &Proposal) -> ConsensusResult {
        let mut weighted_sum = 0.0;
        let mut weight_total = 0.0;

        for member in partition.members() {
            let trust = self.trust_engine.get_vector(&member);
            let weight = self.trust_engine.weighted_norm(&trust, ContextType::Governance);

            let vote = member.vote_on(proposal);

            weighted_sum += weight * vote as f64;
            weight_total += weight;
        }

        let psi = weighted_sum / weight_total;

        ConsensusResult {
            value: psi,
            accepted: psi > self.threshold,
            participation: partition.members().len(),
        }
    }
}
```

---

## IV. Storage / Realm Layer

### 4.1 Realm Hierarchy (Îš1)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   REALM HIERARCHY â€“ DREI-EBENEN-ARCHITEKTUR                                                           â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   Îš1: ğ’_RootRealm âŠƒ ğ’_VirtualRealm âŠƒ ğ’_Partition                                                      â•‘
â•‘                                                                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚  â•‘
â•‘   â”‚                            â”‚         ROOT-REALM              â”‚                                  â”‚  â•‘
â•‘   â”‚                            â”‚   (Universelle Axiome Îš1-Îš28)   â”‚                                  â”‚  â•‘
â•‘   â”‚                            â”‚   rules: {Îš1, ..., Îš28}         â”‚                                  â”‚  â•‘
â•‘   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚  â•‘
â•‘   â”‚                                            â”‚                                                    â”‚  â•‘
â•‘   â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚  â•‘
â•‘   â”‚                    â–¼                       â–¼                       â–¼                            â”‚  â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â•‘
â•‘   â”‚   â”‚    VIRTUAL-REALM A     â”‚ â”‚    VIRTUAL-REALM B     â”‚ â”‚    VIRTUAL-REALM C     â”‚              â”‚  â•‘
â•‘   â”‚   â”‚   (z.B. "Knowledge")   â”‚ â”‚   (z.B. "Finance")     â”‚ â”‚   (z.B. "Creative")    â”‚              â”‚  â•‘
â•‘   â”‚   â”‚   rules: {Îš1-28} + {A} â”‚ â”‚   rules: {Îš1-28} + {B} â”‚ â”‚   rules: {Îš1-28} + {C} â”‚              â”‚  â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â•‘
â•‘   â”‚              â”‚                          â”‚                          â”‚                            â”‚  â•‘
â•‘   â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                      â”‚  â•‘
â•‘   â”‚       â–¼             â–¼            â–¼             â–¼            â–¼             â–¼                      â”‚  â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â•‘
â•‘   â”‚   â”‚Part A1â”‚     â”‚Part A2â”‚   â”‚Part B1â”‚     â”‚Part B2â”‚    â”‚Part C1â”‚     â”‚Part C2â”‚                  â”‚  â•‘
â•‘   â”‚   â”‚Energy â”‚     â”‚Trust  â”‚   â”‚DeFi   â”‚     â”‚Escrow â”‚    â”‚Art    â”‚     â”‚Music  â”‚                  â”‚  â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â•‘
â•‘   â”‚                                                                                                 â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   REGEL-VERERBUNG (Îš1):                                                                               â•‘
â•‘                                                                                                        â•‘
â•‘       Regeln(Partition) âŠ‡ Regeln(VirtualRealm) âŠ‡ Regeln(RootRealm)                                   â•‘
â•‘                                                                                                        â•‘
â•‘       "Kind-Kategorien kÃ¶nnen Regeln hinzufÃ¼gen, nie entfernen."                                      â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

```rust
/// Realm Hierarchy
pub struct RealmHierarchy {
    root: RootRealm,
    virtual_realms: HashMap<RealmId, VirtualRealm>,
    partitions: HashMap<PartitionId, Partition>,
}

pub struct Realm {
    id: RealmId,
    parent: Option<RealmId>,
    rules: RuleSet,
    members: HashSet<DID>,
}

impl RealmHierarchy {
    /// Îš1: Regelvererbung prÃ¼fen
    pub fn validate_rules(&self, partition: &Partition) -> bool {
        let partition_rules = &partition.rules;

        // Find parent virtual realm
        let virtual_realm = self.virtual_realms.get(&partition.parent)
            .expect("Partition must have parent");

        // Check: Partition rules must be superset of virtual realm rules
        virtual_realm.rules.is_subset_of(partition_rules)
            && self.root.rules.is_subset_of(&virtual_realm.rules)
    }

    /// Navigate to a realm
    pub fn resolve_realm(&self, path: &RealmPath) -> Option<&Realm> {
        match path {
            RealmPath::Root => Some(&self.root.as_realm()),
            RealmPath::Virtual(id) => self.virtual_realms.get(id).map(|r| r.as_realm()),
            RealmPath::Partition(id) => self.partitions.get(id).map(|p| p.as_realm()),
        }
    }
}
```

### 4.2 Event Store (Immutable DAG)

```rust
/// Event Store - Immutable Append-Only DAG
pub struct EventStore {
    /// Backend storage (IPFS, local, or hybrid)
    backend: Box<dyn StorageBackend>,

    /// Local index for fast queries
    index: EventIndex,

    /// Merkle roots for anchoring
    merkle_roots: Vec<MerkleRoot>,
}

pub trait StorageBackend: Send + Sync {
    fn put(&self, event: &Event) -> Result<EventId, StorageError>;
    fn get(&self, id: &EventId) -> Result<Option<Event>, StorageError>;
    fn exists(&self, id: &EventId) -> Result<bool, StorageError>;
}

/// IPFS Backend
pub struct IPFSBackend {
    client: IpfsClient,
}

impl StorageBackend for IPFSBackend {
    fn put(&self, event: &Event) -> Result<EventId, StorageError> {
        let cid = self.client.dag_put(event.to_ipld())?;
        Ok(EventId::from_cid(cid))
    }

    fn get(&self, id: &EventId) -> Result<Option<Event>, StorageError> {
        match self.client.dag_get(id.to_cid()) {
            Ok(ipld) => Ok(Some(Event::from_ipld(ipld)?)),
            Err(e) if e.is_not_found() => Ok(None),
            Err(e) => Err(e.into()),
        }
    }
}
```

### 4.3 Identity Store (DIDs)

```rust
/// Identity Store - Self-Sovereign Identity
pub struct IdentityStore {
    /// Local DID documents
    local_dids: HashMap<DID, DIDDocument>,

    /// Delegation graph (âŠ³ relation)
    delegations: DelegationGraph,

    /// Credential vault
    credentials: CredentialVault,
}

/// DID Document nach W3C Spec
#[derive(Serialize, Deserialize)]
pub struct DIDDocument {
    pub id: DID,
    pub verification_methods: Vec<VerificationMethod>,
    pub authentication: Vec<VerificationMethod>,
    pub capability_delegation: Vec<DID>,
    pub service: Vec<Service>,
}

/// Delegation Graph (Îš8)
pub struct DelegationGraph {
    edges: HashMap<DID, Vec<Delegation>>,
}

pub struct Delegation {
    pub from: DID,
    pub to: DID,
    pub capability: Capability,
    pub ttl: Option<Duration>,
    pub conditions: Vec<Condition>,
}

impl DelegationGraph {
    /// Îš8: Irreflexiv prÃ¼fen
    pub fn add_delegation(&mut self, del: Delegation) -> Result<(), DelegationError> {
        // Check: Â¬(s âŠ³ s)
        if del.from == del.to {
            return Err(DelegationError::SelfDelegation);
        }

        // Check: Would create cycle? (Antisymmetry + Transitivity)
        if self.would_create_cycle(&del.from, &del.to) {
            return Err(DelegationError::CyclicDelegation);
        }

        self.edges.entry(del.from.clone()).or_default().push(del);
        Ok(())
    }
}
```

---

## V. Protection Layer

### 5.1 Anti-Calcification (Îš19)

```rust
/// Anti-Calcification - verhindert Macht-Akkumulation
pub struct AntiCalcification {
    gamma: f64,         // Diminishing returns exponent (0.7)
    beta: f64,          // Exploration bonus coefficient
    xi: f64,            // Stochastic fairness noise (0.1)
    tau_exploration: Duration,
}

impl AntiCalcification {
    /// Îš19: rank_final = relevance Â· (Ïƒ^Î³ + Î²Â·(1-ğ”¸)Â·e^(-age/Ï„)) Â· (1 + Î¾Â·noise)
    pub fn compute_rank(&self, subject: &DID, base_relevance: f64, context: &RankingContext) -> f64 {
        let sigma = context.get_sigma(subject);
        let activity = context.get_activity(subject);
        let age = context.get_age(subject);

        // Diminishing returns
        let sigma_component = sigma.powf(self.gamma);

        // Exploration bonus for newcomers
        let exploration_bonus = self.beta
            * (1.0 - activity)
            * (-age.as_secs_f64() / self.tau_exploration.as_secs_f64()).exp();

        // Stochastic fairness
        let noise: f64 = rand::thread_rng().gen_range(-1.0..1.0);
        let fairness_factor = 1.0 + self.xi * noise;

        base_relevance * (sigma_component + exploration_bonus) * fairness_factor
    }
}
```

### 5.2 Diversity Monitor (Îš20)

```rust
/// Diversity Monitor - erkennt Collusion
pub struct DiversityMonitor {
    theta_diversity: usize,  // Minimum unique partners
    tau_window: Duration,    // Time window for partner counting
}

impl DiversityMonitor {
    /// Îš20: diversity_mult = min(1, unique_partners / Î¸_diversity)
    pub fn compute_diversity_multiplier(&self, subject: &DID, history: &TransactionHistory) -> f64 {
        let unique_partners = history
            .transactions_in_window(subject, self.tau_window)
            .iter()
            .map(|tx| tx.counterparty())
            .collect::<HashSet<_>>()
            .len();

        (unique_partners as f64 / self.theta_diversity as f64).min(1.0)
    }

    /// Collusion detection
    pub fn compute_collusion_score(&self, tx: &Transaction, context: &CollusionContext) -> f64 {
        let similarity = context.jaccard_similarity(tx.from(), tx.to());
        let exclusivity = context.exclusivity_ratio(tx.from(), tx.to());
        let temporal_correlation = context.temporal_correlation(tx.from(), tx.to());

        // Weighted combination
        0.4 * similarity + 0.3 * exclusivity + 0.3 * temporal_correlation
    }
}
```

### 5.3 Quadratic Governance (Îš21)

```rust
/// Quadratic Governance - faire Abstimmungen
pub struct QuadraticGovernance {
    max_consecutive_rounds: usize,
}

impl QuadraticGovernance {
    /// Îš21: vote_weight = âˆšÏƒ Â· relevance Â· freshness
    pub fn compute_vote_weight(&self, voter: &DID, proposal: &Proposal, context: &GovernanceContext) -> f64 {
        let sigma = context.get_sigma(voter);
        let relevance = context.get_domain_relevance(voter, proposal.domain());
        let freshness = self.compute_freshness(voter, context);

        sigma.sqrt() * relevance * freshness
    }

    fn compute_freshness(&self, voter: &DID, context: &GovernanceContext) -> f64 {
        let consecutive = context.consecutive_participation_rounds(voter);
        let ratio = consecutive as f64 / self.max_consecutive_rounds as f64;

        1.0 - ratio.powi(2)
    }
}
```

---

## VI. Cross-Cutting Concerns

### 6.1 Cryptography

```rust
/// Cryptographic primitives
pub mod crypto {
    use ed25519_dalek::{Keypair, PublicKey, Signature, Signer, Verifier};
    use bls12_381::{G1Affine, G2Affine, Scalar};

    /// Ed25519 fÃ¼r einzelne Signaturen
    pub fn sign_ed25519(keypair: &Keypair, message: &[u8]) -> Signature {
        keypair.sign(message)
    }

    pub fn verify_ed25519(public_key: &PublicKey, message: &[u8], signature: &Signature) -> bool {
        public_key.verify(message, signature).is_ok()
    }

    /// BLS fÃ¼r Signatur-Aggregation (Consensus)
    pub fn aggregate_bls_signatures(signatures: &[BlsSignature]) -> BlsSignature {
        signatures.iter().fold(BlsSignature::identity(), |acc, sig| acc + sig)
    }

    /// Merkle Tree fÃ¼r Event-Anchoring
    pub fn compute_merkle_root(events: &[Event]) -> MerkleRoot {
        let leaves: Vec<_> = events.iter().map(|e| e.hash()).collect();
        MerkleTree::from_leaves(&leaves).root()
    }
}
```

### 6.2 P2P Networking

```rust
/// P2P Layer using libp2p
pub struct P2PNetwork {
    swarm: Swarm<ErynoaBehaviour>,
    local_peer_id: PeerId,
}

#[derive(NetworkBehaviour)]
pub struct ErynoaBehaviour {
    /// Gossip for event propagation
    gossipsub: Gossipsub,

    /// DHT for peer discovery
    kademlia: Kademlia<MemoryStore>,

    /// Request-Response for direct queries
    request_response: RequestResponse<ErynoaCodec>,

    /// mDNS for local discovery
    mdns: Mdns,
}

impl P2PNetwork {
    /// Broadcast event to partition
    pub async fn broadcast_event(&mut self, event: &Event, partition: &Partition) {
        let topic = Topic::new(format!("erynoa/partition/{}", partition.id));
        let message = event.serialize();

        self.swarm.behaviour_mut().gossipsub
            .publish(topic, message)
            .expect("Publish failed");
    }

    /// Request event from peers
    pub async fn request_event(&mut self, id: &EventId) -> Option<Event> {
        let peers = self.swarm.behaviour_mut().kademlia
            .get_closest_peers(id.as_bytes());

        for peer in peers {
            if let Ok(event) = self.request_from_peer(&peer, id).await {
                return Some(event);
            }
        }
        None
    }
}
```

### 6.3 Configuration

```toml
# erynoa.toml - Peer Configuration

[identity]
did = "did:erynoa:self:abc123"
key_file = "~/.erynoa/keys/primary.key"

[network]
listen_addresses = ["/ip4/0.0.0.0/tcp/9000", "/ip6/::/tcp/9000"]
bootstrap_peers = [
    "/dns4/bootstrap1.erynoa.network/tcp/9000/p2p/QmXyz...",
    "/dns4/bootstrap2.erynoa.network/tcp/9000/p2p/QmAbc...",
]

[storage]
backend = "ipfs"  # or "local", "hybrid"
ipfs_api = "http://localhost:5001"
cache_size_mb = 1024

[trust]
asymmetry_factors = [1.5, 1.5, 1.5, 1.5, 2.0, 2.0]  # R, I, C, P, V, Î©
decay_half_life_positive_days = 1825  # 5 Jahre
decay_half_life_negative_days = 1095  # 3 Jahre

[consensus]
threshold = 0.667  # 2/3 SupermajoritÃ¤t
timeout_ms = 30000

[protection]
anti_calcification_gamma = 0.7
exploration_bonus_beta = 0.2
stochastic_fairness_xi = 0.1
diversity_threshold = 10
```

---

## VII. Technologie-Stack

### 7.1 Empfohlener Stack

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   TECHNOLOGIE-STACK                                                                                   â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   LAYER              TECHNOLOGIE                   BEGRÃœNDUNG                                         â•‘
â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘
â•‘                                                                                                        â•‘
â•‘   Backend/Core       Rust                          Memory Safety, Performance, WASM                   â•‘
â•‘                      + tokio                       Async Runtime                                       â•‘
â•‘                      + serde                       Serialization                                       â•‘
â•‘                                                                                                        â•‘
â•‘   Cryptography       ed25519-dalek                 Signaturen                                          â•‘
â•‘                      bls12_381                     Aggregation                                         â•‘
â•‘                      sha3                          Hashing                                             â•‘
â•‘                                                                                                        â•‘
â•‘   P2P                libp2p                        Modulare Netzwerk-Stack                             â•‘
â•‘                      + gossipsub                   Event-Broadcast                                     â•‘
â•‘                      + kademlia                    DHT                                                 â•‘
â•‘                                                                                                        â•‘
â•‘   Storage            IPFS/IPLD                     Content-Addressed, Merkle-DAG                       â•‘
â•‘                      sled                          Embedded Index DB                                   â•‘
â•‘                                                                                                        â•‘
â•‘   Frontend           Tauri                         Cross-Platform Desktop                              â•‘
â•‘                      Svelte                        Reactive UI                                         â•‘
â•‘                      TypeScript                    Type Safety                                         â•‘
â•‘                                                                                                        â•‘
â•‘   Mobile             Flutter                       iOS + Android                                       â•‘
â•‘                      + rust-ffi                    Core als Native Library                             â•‘
â•‘                                                                                                        â•‘
â•‘   Prototyping        Python                        Schnelles Testen                                    â•‘
â•‘                      + numpy                       Trust-Berechnungen                                  â•‘
â•‘                      + networkx                    DAG-Visualisierung                                  â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   WASM TARGET:                                                                                        â•‘
â•‘       Core Logic kompiliert zu WASM fÃ¼r Browser-Peers (Light Clients)                                 â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 7.2 Projekt-Struktur

```
erynoa/
â”œâ”€â”€ Cargo.toml                    # Workspace
â”œâ”€â”€ crates/
â”‚   â”œâ”€â”€ erynoa-core/              # Core Logic (Axiome)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ event/            # Event Engine (Îš9-Îš12)
â”‚   â”‚   â”‚   â”œâ”€â”€ trust/            # Trust Engine (Îš2-Îš5)
â”‚   â”‚   â”‚   â”œâ”€â”€ surprisal/        # Surprisal Calculator (Îš15a)
â”‚   â”‚   â”‚   â”œâ”€â”€ worldformula/     # World Formula (Îš15b-d)
â”‚   â”‚   â”‚   â”œâ”€â”€ consensus/        # Consensus Engine (Îš18)
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”‚
â”‚   â”œâ”€â”€ erynoa-peer/              # Peer Node
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ gateway/          # Gateway Guard (Îš23)
â”‚   â”‚   â”‚   â”œâ”€â”€ composer/         # Saga Composer (Îš22)
â”‚   â”‚   â”‚   â”œâ”€â”€ parser/           # Intent Parser
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”‚
â”‚   â”œâ”€â”€ erynoa-storage/           # Storage Layer
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ event_store/
â”‚   â”‚   â”‚   â”œâ”€â”€ identity_store/
â”‚   â”‚   â”‚   â”œâ”€â”€ realm/
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”‚
â”‚   â”œâ”€â”€ erynoa-protection/        # Protection Layer
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ anti_calcification/  (Îš19)
â”‚   â”‚   â”‚   â”œâ”€â”€ diversity/           (Îš20)
â”‚   â”‚   â”‚   â”œâ”€â”€ governance/          (Îš21)
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs
â”‚   â”‚   â””â”€â”€ Cargo.toml
â”‚   â”‚
â”‚   â”œâ”€â”€ erynoa-crypto/            # Cryptography
â”‚   â”œâ”€â”€ erynoa-p2p/               # P2P Networking
â”‚   â””â”€â”€ erynoa-cli/               # CLI Tool
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ console/                  # Admin Console (Svelte)
â”‚   â”œâ”€â”€ platform/                 # User Platform (Svelte)
â”‚   â””â”€â”€ mobile/                   # Mobile App (Flutter)
â”‚
â”œâ”€â”€ proto/                        # Protocol Buffers
â”‚   â””â”€â”€ erynoa/
â”‚       â”œâ”€â”€ event.proto
â”‚       â”œâ”€â”€ trust.proto
â”‚       â””â”€â”€ consensus.proto
â”‚
â””â”€â”€ documentation/
    â””â”€â”€ concept-v4/
        â”œâ”€â”€ LOGIC.md
        â””â”€â”€ SYSTEM-ARCHITECTURE.md  (diese Datei)
```

---

## VIII. Datenfluss-Beispiele

### 8.1 Neuer Beitrag (Post Knowledge)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   DATENFLUSS: WISSENS-BEITRAG                                                                         â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   1. USER INPUT                                                                                       â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                       â•‘
â•‘      User: "Teile Artikel Ã¼ber Quantencomputing im Knowledge-Realm"                                   â•‘
â•‘                                                                                                        â•‘
â•‘   2. INTENT PARSING                                                                                   â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                   â•‘
â•‘      Intent {                                                                                         â•‘
â•‘          goal: Create { entity_type: Knowledge, content: "..." },                                     â•‘
â•‘          context: Realm("knowledge/quantum"),                                                         â•‘
â•‘      }                                                                                                â•‘
â•‘                                                                                                        â•‘
â•‘   3. SAGA COMPOSITION (Îš22)                                                                           â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â•‘
â•‘      Saga [                                                                                           â•‘
â•‘          Step 1: verify_identity(user),                                                               â•‘
â•‘          Step 2: check_realm_membership(user, "knowledge/quantum"),                                   â•‘
â•‘          Step 3: validate_content(content),                                                           â•‘
â•‘          Step 4: create_event(KnowledgePost),                                                         â•‘
â•‘          Step 5: broadcast_to_partition(),                                                            â•‘
â•‘      ]                                                                                                â•‘
â•‘                                                                                                        â•‘
â•‘   4. GATEWAY GUARD (Îš23)                                                                              â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                             â•‘
â•‘      guard(user, "knowledge/quantum") â†’ ALLOWED                                                       â•‘
â•‘      Trust-DÃ¤mpfung: ğ•_quantum = M_knowledge Ã— ğ•_user                                                â•‘
â•‘                                                                                                        â•‘
â•‘   5. EVENT CREATION (Îš12)                                                                             â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                             â•‘
â•‘      Event {                                                                                          â•‘
â•‘          id: hash(...),                                                                               â•‘
â•‘          parents: [latest_in_partition],                                                              â•‘
â•‘          payload: KnowledgePost { content, tags, ... },                                               â•‘
â•‘          finality: NASCENT,                                                                           â•‘
â•‘      }                                                                                                â•‘
â•‘                                                                                                        â•‘
â•‘   6. TRUST UPDATE (Îš2-Îš5)                                                                             â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                             â•‘
â•‘      Î”ğ•_C(user) = +0.01  (Competence durch Wissensnachweis)                                          â•‘
â•‘                                                                                                        â•‘
â•‘   7. SURPRISAL CALCULATION (Îš15a)                                                                     â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                     â•‘
â•‘      â„(event) = âˆ’logâ‚‚ P(quantum_topic | recent_posts) = 3.2 bits                                     â•‘
â•‘      ğ’®(event) = â€–ğ•(user)â€–Â² Ã— â„ = 0.64 Ã— 3.2 = 2.05                                                  â•‘
â•‘                                                                                                        â•‘
â•‘   8. WORLD FORMULA UPDATE (Îš15d)                                                                      â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                     â•‘
â•‘      ğ”¼(t+1) = Î± Ã— ğ”¼(t) + (1-Î±) Ã— contribution(user)                                                  â•‘
â•‘                                                                                                        â•‘
â•‘   9. PARTITION CONSENSUS (Îš18)                                                                        â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                        â•‘
â•‘      Î¨(quantum_partition)(event.valid) = 0.78 > 0.67 â†’ ACCEPTED                                       â•‘
â•‘      Event transitions: NASCENT â†’ VALIDATED â†’ WITNESSED                                               â•‘
â•‘                                                                                                        â•‘
â•‘   10. PROTECTION CHECK (Îš19-Îš21)                                                                      â•‘
â•‘       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                       â•‘
â•‘       Anti-Calcification: rank(user) = relevance Ã— Ïƒ^0.7 Ã— freshness                                  â•‘
â•‘       Diversity: unique_partners = 12 > 10 â†’ OK                                                       â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## IX. Deployment & Operations

### 9.1 Deployment-Modi

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   DEPLOYMENT-MODI                                                                                     â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   1. FULL NODE                                                                                        â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                         â•‘
â•‘      â€¢ Speichert komplette Event-Historie                                                             â•‘
â•‘      â€¢ Partizipiert an Konsens                                                                        â•‘
â•‘      â€¢ Hosts: Servers, Power-Users                                                                    â•‘
â•‘      â€¢ Resources: 8GB+ RAM, 100GB+ Storage                                                            â•‘
â•‘                                                                                                        â•‘
â•‘   2. LIGHT NODE                                                                                       â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                       â•‘
â•‘      â€¢ Speichert nur eigene Events + Merkle-Proofs                                                   â•‘
â•‘      â€¢ Verifiziert via Proofs                                                                         â•‘
â•‘      â€¢ Hosts: Desktop Apps, Laptops                                                                   â•‘
â•‘      â€¢ Resources: 2GB RAM, 10GB Storage                                                               â•‘
â•‘                                                                                                        â•‘
â•‘   3. BROWSER NODE (WASM)                                                                              â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                             â•‘
â•‘      â€¢ Core Logic in WASM                                                                             â•‘
â•‘      â€¢ Kein lokaler Storage (Session-only)                                                            â•‘
â•‘      â€¢ Verbindet zu Light/Full Nodes                                                                  â•‘
â•‘      â€¢ Hosts: Web-Browser                                                                             â•‘
â•‘      â€¢ Resources: Modern Browser                                                                       â•‘
â•‘                                                                                                        â•‘
â•‘   4. MOBILE NODE                                                                                      â•‘
â•‘      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                                      â•‘
â•‘      â€¢ Light Node mit Offline-Sync                                                                    â•‘
â•‘      â€¢ Background Sync bei WiFi                                                                       â•‘
â•‘      â€¢ Hosts: iOS/Android Apps                                                                        â•‘
â•‘      â€¢ Resources: 512MB RAM, 1GB Storage                                                              â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 9.2 Metriken & Monitoring

```rust
/// Telemetry fÃ¼r System-Gesundheit
pub struct SystemMetrics {
    // World Formula
    pub e_current: Gauge,
    pub e_delta_per_hour: Gauge,

    // Trust
    pub avg_trust_by_dimension: [Gauge; 6],
    pub trust_updates_per_second: Counter,

    // Events
    pub events_per_second: Counter,
    pub events_by_finality: [Counter; 5],
    pub dag_depth: Gauge,

    // Consensus
    pub consensus_rounds: Counter,
    pub consensus_success_rate: Gauge,

    // Network
    pub connected_peers: Gauge,
    pub bandwidth_in: Counter,
    pub bandwidth_out: Counter,

    // Protection
    pub anti_calcification_adjustments: Counter,
    pub collusion_detections: Counter,
}
```

---

## X. Zusammenfassung

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                                        â•‘
â•‘   ERYNOA SYSTEM-ARCHITEKTUR V4.1 â€“ ZUSAMMENFASSUNG                                                    â•‘
â•‘                                                                                                        â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
â•‘                                                                                                        â•‘
â•‘   SCHICHTEN:                                                                                          â•‘
â•‘       â€¢ Client/Peer Layer:    Gateway + Composer (Îš22-Îš24)                                           â•‘
â•‘       â€¢ Core Logic Layer:     Event, Trust, Surprisal, Weltformel, Konsens                           â•‘
â•‘       â€¢ Storage/Realm Layer:  Hierarchische Realms (Îš1), Immutable DAG                               â•‘
â•‘       â€¢ Protection Layer:     Anti-Degeneration (Îš19-Îš21)                                            â•‘
â•‘                                                                                                        â•‘
â•‘   EIGENSCHAFTEN:                                                                                      â•‘
â•‘       âœ“ Dezentral:        P2P ohne Single Point of Failure                                           â•‘
â•‘       âœ“ Skalierbar:       Hierarchische Approximation (Îš15d)                                         â•‘
â•‘       âœ“ Human-Aligned:    Ä¤-Faktor bevorzugt Menschen (Îš16)                                          â•‘
â•‘       âœ“ Formal Korrekt:   Aus Axiomen abgeleitet                                                     â•‘
â•‘       âœ“ Anti-Gaming:      Quadratische Trust-DÃ¤mpfung, Diversity-Checks                              â•‘
â•‘                                                                                                        â•‘
â•‘   TECHNOLOGIE:                                                                                        â•‘
â•‘       â€¢ Rust + WASM fÃ¼r Core                                                                         â•‘
â•‘       â€¢ libp2p fÃ¼r Networking                                                                        â•‘
â•‘       â€¢ IPFS fÃ¼r Storage                                                                             â•‘
â•‘       â€¢ Svelte/Tauri fÃ¼r Frontend                                                                    â•‘
â•‘                                                                                                        â•‘
â•‘   AXIOM-MAPPING:                                                                                      â•‘
â•‘       Îš1      â†’ Realm Hierarchy                                                                      â•‘
â•‘       Îš2-Îš5   â†’ Trust Engine                                                                         â•‘
â•‘       Îš9-Îš12  â†’ Event Engine                                                                         â•‘
â•‘       Îš15a-d  â†’ Surprisal + World Formula Engine                                                     â•‘
â•‘       Îš16-Îš17 â†’ Human-Alignment + Temporal Weights                                                   â•‘
â•‘       Îš18     â†’ Consensus Engine                                                                     â•‘
â•‘       Îš19-Îš21 â†’ Protection Layer                                                                     â•‘
â•‘       Îš22-Îš24 â†’ Peer Layer (Gateway + Composer)                                                      â•‘
â•‘       Îš25-Îš28 â†’ System Guarantees (Cross-Cutting)                                                    â•‘
â•‘                                                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

_Erynoa System-Architektur V4.1 â€“ Axiom-Abgeleitete Implementierbare Architektur._
_Dezentral, Skalierbar, Human-Aligned._
_"Die Architektur ist die VerkÃ¶rperung der Logik."_
